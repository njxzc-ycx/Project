<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link href="http://localhost:8088/shopsystem/hospital/css/bootstrap.min.css" rel="stylesheet">
    <link href="http://localhost:8088/shopsystem/hospital/css/ie10-viewport-bug-workaround.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
    <script>
        function lick(obj,id) {
            var td_content = $(obj).parents("tr").children("td");  //获取当前行中的所有td值
            var comId = td_content.eq(0).text(); //获取当前行第一个td的值
            $('#con').load('http://localhost:8088/shopsystem/commodity/toComDetail/'+comId);
        };
        //首页
        $(document).ready(function(){
            $("#indexPage").click(function(){
                $('#con').load('http://localhost:8088/shopsystem/commodity/toAllComByPage?strPageIndex='+1);
            });

        });
        //上一页
        function upPage(pageIndex) {
            if(pageIndex==1){
                $('#con').load('http://localhost:8088/shopsystem/commodity/toAllComByPage?strPageIndex='+pageIndex);
            }else {
                var strPageIndex = pageIndex - 1;
                $('#con').load('http://localhost:8088/shopsystem/commodity/toAllComByPage?strPageIndex=' + strPageIndex);
            }
        };
        //下一页
        function nextPage(pageIndex,pageCount) {
            var strPageIndex;
            if (pageIndex==pageCount){
                strPageIndex = pageCount;
                $('#con').load('http://localhost:8088/shopsystem/commodity/toAllComByPage?strPageIndex='+strPageIndex);
            }else {
                strPageIndex = pageIndex+1;
                $('#con').load('http://localhost:8088/shopsystem/commodity/toAllComByPage?strPageIndex='+strPageIndex);
            }

        };
        //尾页
        function endPage(strPageIndex) {
            $('#con').load('http://localhost:8088/shopsystem/commodity/toAllComByPage?strPageIndex='+strPageIndex);
        };
        //上架
        function onSale(comId,flag) {
            $('#con').load('http://localhost:8088/shopsystem/commodity/updateComFlag/'+comId+'/'+flag);
        };
        function offSale(comId,flag) {
            $('#con').load('http://localhost:8088/shopsystem/commodity/updateComFlag/'+comId+'/'+flag);
        };


    </script>
</head>
<body>



<div id="showItem" class="table-responsive" style="width:100%" >
    <ol class="breadcrumb">
        <li class="active">商品信息</li>
    </ol>
    <table class="table table-striped">
        <thead>
        <tr>
            <th>编号</th>
            <th>图片</th>
            <th>名称</th>
            <th>描述</th>
            <th>分类</th>
            <th>卖家</th>
            <th>价格</th>
            <th>数量</th>
            <th>状态</th>
            <th>操作</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="ac:${allCommodities}">
            <td><span th:text="${ac.comId}"></span></td>
            <td th:if="${null!=ac.comImageMain}">
                <img  th:src="${ac.comImageMain}" width="150px"
                      height="150px" >
            </td>
            <td th:if="${null==ac.comImageMain}">
                <img  th:src="'http://localhost:8088/shopsystem/resources/image/default.jpg'" width="150px"
                      height="150px" >
            </td>
            <td><span th:text="${ac.comName}"></span></td>
            <td><span th:text="${ac.des}"></span></td>
            <td><span th:text="${ac.typethird.thirdName}"></span></td>
            <td><span th:text="${ac.user.realName}"></span></td>
            <td><span th:text="${ac.currentPrice}"></span></td>
            <td><span th:text="${ac.count}"></span></td>
            <td><span th:text="${ac.flag==0?'待审核':ac.flag==1?'上架中':ac.flag==2?'已下架':'审核不通过'}"></span></td>
            <td>
                <button class="btn btn-info" th:id="${ac.comId}" th:type="button"   onclick="lick(this,this.id)">商品详细</button>
                <button class="btn btn-info" th:if="${ac.flag==0||ac.flag==2}" th:onclick="'onSale('+${ac.comId}+','+${ac.flag}+')'">上架</button>
                <button class="btn btn-info" th:if="${ac.flag==1}" th:onclick="'offSale('+${ac.comId}+','+${ac.flag}+')'">下架</button>
            </td>
        </tr>
        </tbody>
    </table>
</div>
<div style="text-align: center;width:100%;position: fixed;bottom: 50px;">
    <button class="btn btn-default"  id="indexPage" >首页</button>
    <button class="btn btn-default" th:onclick="'upPage('+${pageIndex}+')'" >上一页</button>
    <button class="btn btn-default" th:onclick="'nextPage('+${pageIndex}+','+${pageCount}+')'" >下一页</button>
    <button class="btn btn-default" th:onclick="'endPage('+${pageCount}+')'"  >尾页</button>
    <span th:text="'总页数：'+${pageCount}+'，当前在第'+${pageIndex}+'页'"></span>
</div>



</body>
</html>